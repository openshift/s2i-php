#!/bin/bash

set -e

set -eo pipefail

shopt -s dotglob ## para mover los archivos ocultos



#NOOOO contextDir=builder/
#SIIII dockerfilePath: 7.2/Dockerfile



mv /tmp/src/builder/assemble /opt/app-root/s2i/assemble
mv /tmp/src/builder/run /opt/app-root/s2i/run
mv /tmp/src/builder/runSH /opt/app-root/s2i/runSH
mv /tmp/src//builder/save-artifacts /opt/app-root/s2i/save-artifacts



# No es necesario ya que con openshift podemos incluir dichos valores en el buildconfig
# mkdir -p /tmp/.s2i
# mv /tmp/src/builder/image_metadata.json /tmp/.s2i/image_metadata.json


#Instalamos algunos paquetes de nodejs

npm install gulp --global
npm install gulp-rename --global
npm install gulp-concat --global
npm install fs-extra --global


# Fix source directory permissions
fix-permissions ./
fix-permissions /opt/app-root
fix-permissions ${HTTPD_CONFIGURATION_PATH}
